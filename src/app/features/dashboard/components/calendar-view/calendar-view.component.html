<section class="view">
  <header class="view__header">
    <div>
      <h2>Content Calendar</h2>
      <p>Manage your scheduled posts.</p>
    </div>
    <button type="button" class="btn btn-gradient">
      <mat-icon>event</mat-icon>
      Schedule New Post
    </button>
  </header>

  <div class="calendar-layout">
    <div class="card calendar-grid">
      <header class="calendar-grid__header">
        <h3>{{ monthName }} {{ currentYear }}</h3>
        <div class="calendar-grid__controls">
          <button type="button" class="btn btn-outline btn-sm" (click)="previousMonth()" [disabled]="isLoading">
            <mat-icon>chevron_left</mat-icon>
          </button>
          <button type="button" class="btn btn-outline btn-sm" (click)="goToToday()" [disabled]="isLoading">
            Today
          </button>
          <button type="button" class="btn btn-outline btn-sm" (click)="nextMonth()" [disabled]="isLoading">
            <mat-icon>chevron_right</mat-icon>
          </button>
        </div>
      </header>

      <div class="calendar-grid__weekdays">
        <span *ngFor="let day of ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']">
          {{ day }}
        </span>
      </div>

      <div class="calendar-grid__days">
        <div
          *ngFor="let day of calendarDays"
          class="calendar-day"
          [class.calendar-day--muted]="!day.isCurrentMonth"
          [class.calendar-day--today]="day.isToday"
          [class.calendar-day--has-post]="day.hasWorkflow"
          [class.calendar-day--selected]="isDaySelected(day)"
          [class.calendar-day--clickable]="day.isCurrentMonth && day.hasWorkflow"
          (click)="selectDay(day)"
        >
          {{ day.day || '' }}
          <span *ngIf="day.hasWorkflow" class="calendar-day__dot"></span>
        </div>
      </div>
    </div>

    <div class="card calendar-sidebar">
      <h3>{{ sidebarTitle }}</h3>
      <div class="calendar-sidebar__list">
        <!-- Loading State -->
        <div *ngIf="isLoading" class="loading-state">
          <p>Loading...</p>
        </div>

        <!-- Error State -->
        <div *ngIf="error && !isLoading" class="error-state">
          <p>{{ error }}</p>
          <button type="button" class="btn btn-gradient" (click)="loadCalendar()">
            <mat-icon>refresh</mat-icon>
            Retry
          </button>
        </div>

        <!-- Workflows List -->
        <article *ngFor="let workflow of upcomingWorkflows" class="calendar-sidebar__item">
          <div class="calendar-sidebar__item-header">
            <div class="calendar-sidebar__icon">
              <mat-icon>play_arrow</mat-icon>
            </div>
            <span>{{ workflow.name }}</span>
          </div>
          <div class="calendar-sidebar__meta">
            <span>{{ formatDate(workflow.nextRunAt) }} Â· {{ workflow.time }}</span>
            <span class="badge badge-outline">{{ workflow.frequency }}</span>
          </div>
        </article>

        <!-- Empty State -->
        <p *ngIf="!isLoading && !error && upcomingWorkflows.length === 0" class="empty-state">
          <ng-container *ngIf="selectedDay; else noWorkflows">
            No workflows scheduled for this day.
          </ng-container>
          <ng-template #noWorkflows>
            No upcoming workflows scheduled.
          </ng-template>
        </p>
      </div>
    </div>
  </div>
</section>


